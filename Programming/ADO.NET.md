
**ADO.NET**— это набор классов в .NET, предназначенных для работы с данными: подключение к базам данных, выполнение запросов, чтение результатов и т. д.


Осуществлние подключения к базе данных представляет довольно затратную с точки зрения времени операцию, посколько в процессе подключения системе надо выполнить кучу шагов: парсинг строки подключения, проверка подключения сервером и т.д. При этом в программе, как правило, используются по несколько раз одни и те же конфигурации подключения (которые имеют одну и ту же строку подключения). И чтобы оптимизировать процессе подключения, в ADO.NET используется механизм **[[Пул подключений]]**.

Команды в ADO.NET представлены объектом интерфейса System.Data.IDbCommand. Пакет Microsoft.Data.SqlClient предоставляет его реализацию в виде класса SqlCommand. Этот класс инкапсулирует sql-выражение, которое должно быть выполнено.

### Выполнение команды

Чтобы выполнить команду, необходимо применить один из методов SqlCommand:

- ExecuteNonQuery()/ExecuteNonQueryAsync(): просто выполняет sql-выражение и возвращает количество измененных записей. Подходит для sql-выражений INSERT, UPDATE, DELETE, CREATE.
    
- ExecuteReader()/ExecuteReaderAsync(): выполняет sql-выражение и возвращает строки из таблицы. Подходит для sql-выражения SELECT.
    
- ExecuteScalar()/ExecuteScalarAsync(): выполняет sql-выражение и возвращает одно скалярное значение, например, число. Подходит для sql-выражения SELECT в паре с одной из встроенных функций SQL, как например, Min, Max, Sum, Count.


### SqlParameter
В ADO.NET класс `SqlParameter` используется для **безопасной и корректной передачи параметров в SQL-запросы и команды**, выполняемые через `SqlCommand`. Это особенно важно по следующим причинам:

Для определения параметров используется объект SqlParameter. Этот объект имеет ряд конструкторов, наиболее используемые из них:

- SqlParameter()
    
- SqlParameter(String, Object): первый параметр конструктора передает имя, а второй - значение параметра
    
- SqlParameter(String, SqlDbType): первый параметр конструктора передает имя параметра, а второй - его тип в виде объекта SqlDbType
    
- SqlParameter(String, SqlDbType, Int32): первый параметр конструктора передает имя параметра, второй - его тип в виде объекта SqlDbType, а третий - размер
    
- SqlParameter(String, SqlDbType, Int32, String): конструктор последовательно принимает значения для имя параметра, его типа, размера и имени стобца в таблице

1. **Безопасность — защита от SQL-инъекций**
2. **Автоматическая подстановка и приведение типов**
3. **Переиспользуемость и читаемость**
4. **Поддержка хранимых процедур**


## Работа с хранимыми процедурами

Хранимые процедуры являются еще одной формой выполнения запросов к базе данных. Но по сравнению с ранее рассмотренными запросами, которые посылаются из приложения базе данных, хранимые процедуры определяются на сервере и предоставляют большую производительность и являются более безопасными.Объект SqlCommand имеет встроенную поддержку хранимых процедур. В частности у него определено свойство `CommandType`, которое в качестве значения принимает значение из перечисления `System.Data.CommandType`. И значение `System.Data.CommandType.StoredProcedure` как раз указывает, что будет использоваться хранимая процедура.




### Что надо доучить:

1. **Что такое ADO.NET и архитектура**
    
    - Connected vs. Disconnected модель
        
    - Data Providers (`SqlClient`, `OleDb`, `Odbc` и т.д.)
        
2. **SqlConnection**
    
    - Подключение к базе данных
        
    - Строка подключения (Connection String)
        
3. **SqlCommand**
    
    - Выполнение запросов: `ExecuteNonQuery`, `ExecuteScalar`, `ExecuteReader`
        
4. **SqlDataReader**
    
    - Построчное чтение данных из базы
        
5. **SqlParameter**
    
    - Работа с параметрами
        
    - Защита от SQL-инъекций
        
6. **Обработка исключений и `using`-блоки**
    
    - Управление ресурсами
        
    - `try-catch-finally`
    
7. **[[DataSet, DataTable, DataAdapter]]*
    
    - Disconnected модель
        
    - Ручное заполнение таблиц
        
8. **DataAdapter**

9. **CommandBuilder**
    
    - Автоматическая генерация SQL-команд (`INSERT`, `UPDATE`, `DELETE`)
        
10. **Хранимые процедуры (Stored Procedures)**
    
    - Вызов SP через `SqlCommand`
        
    - Передача входных и выходных параметров
        
11. **[[Транзакции в ADO.NET]]**
    
    - `SqlTransaction`, `BeginTransaction`, `Commit`, `Rollback`
        
12. **Асинхронная работа (Async ADO.NET)**
    
    - `ExecuteReaderAsync`, `OpenAsync` и т.д.
        
13. **Кеширование данных**
    
    - `SqlCacheDependency`
        
    - Работа с кэшем на стороне клиента
        
14. **Работа с BLOB-данными**
    
    - Чтение/запись изображений, файлов и т.п.
        
15. **Bulk Insert (массовая вставка)**
    
    - `SqlBulkCopy`
        
16. **Connection Pooling (пул соединений)**
    
    - Как работает
        
    - Управление через строку подключения
        
17. **Entity Framework vs ADO.NET**
    
    - Когда использовать ADO.NET напрямую
        
