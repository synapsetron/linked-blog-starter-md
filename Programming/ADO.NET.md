
**ADO.NET**— это набор классов в .NET, предназначенных для работы с данными: подключение к базам данных, выполнение запросов, чтение результатов и т. д.


Осуществлние подключения к базе данных представляет довольно затратную с точки зрения времени операцию, посколько в процессе подключения системе надо выполнить кучу шагов: парсинг строки подключения, проверка подключения сервером и т.д. При этом в программе, как правило, используются по несколько раз одни и те же конфигурации подключения (которые имеют одну и ту же строку подключения). И чтобы оптимизировать процессе подключения, в ADO.NET используется механизм **[[Пул подключений]]**.

Команды в ADO.NET представлены объектом интерфейса System.Data.IDbCommand. Пакет Microsoft.Data.SqlClient предоставляет его реализацию в виде класса SqlCommand. Этот класс инкапсулирует sql-выражение, которое должно быть выполнено.

### Выполнение команды

Чтобы выполнить команду, необходимо применить один из методов SqlCommand:

- ExecuteNonQuery()/ExecuteNonQueryAsync(): просто выполняет sql-выражение и возвращает количество измененных записей. Подходит для sql-выражений INSERT, UPDATE, DELETE, CREATE.
    
- ExecuteReader()/ExecuteReaderAsync(): выполняет sql-выражение и возвращает строки из таблицы. Подходит для sql-выражения SELECT.
    
- ExecuteScalar()/ExecuteScalarAsync(): выполняет sql-выражение и возвращает одно скалярное значение, например, число. Подходит для sql-выражения SELECT в паре с одной из встроенных функций SQL, как например, Min, Max, Sum, Count.




Для определения параметров используется объект SqlParameter. Этот объект имеет ряд конструкторов, наиболее используемые из них:

- SqlParameter()
    
- SqlParameter(String, Object): первый параметр конструктора передает имя, а второй - значение параметра
    
- SqlParameter(String, SqlDbType): первый параметр конструктора передает имя параметра, а второй - его тип в виде объекта SqlDbType
    
- SqlParameter(String, SqlDbType, Int32): первый параметр конструктора передает имя параметра, второй - его тип в виде объекта SqlDbType, а третий - размер
    
- SqlParameter(String, SqlDbType, Int32, String): конструктор последовательно принимает значения для имя параметра, его типа, размера и имени стобца в таблице